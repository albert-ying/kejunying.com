<!DOCTYPE html>
<html><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta name="description" content="//localhost:1313/">
    <meta name="keywords" content="personal, science">

    <meta property="og:site_name" content="Kejun Albert Ying">
    <meta property="og:title" content="Kejun Albert Ying">
    <meta property="og:description" content="Visualizing the Dutch elections throughout the night">
    <meta property="og:type" content="website">
    <meta property="og:url" content="//localhost:1313/blog/visualizing-the-dutch-elections/">
    <meta property="og:image" content="//localhost:1313/">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="//localhost:1313/blog/visualizing-the-dutch-elections/">
    <meta name="twitter:image" content="//localhost:1313/">

    
    <link rel="stylesheet" type="text/css" href="//localhost:1313/css/style.css">
    
    
    
        
        <link rel="stylesheet" href="/custom_style.css" integrity="">
    

    <link rel="stylesheet" href="https://use.typekit.net/jxt2fnp.css"> 
    <link rel="stylesheet" href="https://use.typekit.net/uwd7war.css"> 
    <link href="https://fonts.cdnfonts.com/css/cooper-hewitt" rel="stylesheet">
    
    
        <meta name="description" content="Kejun (Albert) Ying&#39;s personal website">
    

    
        
            <link rel="shortcut icon" href="/Albert_headshot.jpg">
        
    

    
    
    
    
    
    <title>visualizing the dutch elections throughout the night | kejun albert ying</title>
</head><body><div id="top-stripe"></div><div id="content">

    <div class="article-nav-outer">
        <div class="article-nav-inner">
            <a class="internal" hyphens="none" href='/blog'>← back to blog</a>
        </div>
    </div>

<h2 class="article-title">Visualizing the Dutch elections throughout the night</h2>
<div id="doc">
    <div class="hanging-subtitle">
        
                
        
            
                <p>22 November 2023</p>
            
        
    </div>
<p>So it&rsquo;s time again for the Netherlands to have another election for the Dutch parliament (<a href="https://en.wikipedia.org/wiki/House_of_Representatives_(Netherlands)"><em>Tweede Kamer</em></a>) The previous one was only in 2021, and we had elections in 2023 already for the Provinces and indirectly for the Dutch &ldquo;Senate&rdquo; (<a href="https://en.wikipedia.org/wiki/Senate_(Netherlands)"><em>Eerste Kamer</em></a>), but the parliamentary elections are the most important ones, usually taking place every four years (until one of the coalition partners believes they cannot support the government anymore, or if one of parties in government believe it&rsquo;s in their best interest to have another election sooner rather than later).</p>
<p>Anyway, parliamentary elections are a prime example of how and why data vizualization is important. Data is used extensively throughout the political campaigns to get political points across (whether it&rsquo;s used justly or disingenuously). For data analysts and data journalists, vizualizing the polls, results, and trends as the data comes in is a key challenge throughout the night. Since this is a unique event that happens (hopefully) only once every four years, so I thought I&rsquo;d jump on the opportunity to provide my (admittedly unrequested) take on the data visualizations that are important to share.</p>
<p>The plots I&rsquo;ll share here are a bit more complicated than the usual ones (especially in cases where I actively try to recreate a plot), so I&rsquo;ll hide the code to each plot by default, but you can see the code by clicking &ldquo;Show code&rdquo; or &ldquo;Show code for the plot&rdquo;.</p>
<p>I&rsquo;ll also separate this post in when I added the new plots and data. I&rsquo;ll mark the (general) time I added a new section.</p>
<div class="omission"></div>
<h2 id="21-november">21 November</h2>
<p>Some of the plots I could create beforehand, this data about the polls leading up to election dayy. I also made sure to create a few datasets that might help me speed up the work during election night. So I&rsquo;ll add color and accent colors and their political identity. First, I&rsquo;ll load the packages we&rsquo;ll use here. I&rsquo;ll also load a custom font I&rsquo;ll use for the plots.</p>
<details>
<summary>Show code</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(tidyverse)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggtext)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(rvest)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(showtext)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(patchwork)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">font_add_google</span>(<span style="color:#e6db74">&#34;Bitter&#34;</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">showtext_auto</span>()
</span></span></code></pre></div></details>
<div class="sidenote"  style="padding-top: 3em;">There are a ton of voting advice websites, but only a few (including <em>KiesKompas</em>) are generally recommended by a variety of political parties across the spectrum</div>
<p>Then we can create a data frame with the party names and their identifying colors. I&rsquo;ll also add their political identity, i.e. how far left or right the parties are and how progressive or conservative the parties are. This data comes from the webpage <a href="https://tweedekamer2023.kieskompas.nl/nl/results/compass"><em>the political landscape</em></a> from the Dutch voting advice website <a href="https://www.kieskompas.nl"><em>KiesKompas</em></a> which offers one of the most popular application that helps voters identify what parties their values most closely align with. It&rsquo;s a tool by the Vrije Universiteit Amsterdam (VU Amsterdam) and is generally well-respected. However, their political landscape is a bit controversial because it tends to &ldquo;average&rdquo; across a set of issues, while perhaps ignoring some of the key identifying issue a party is campaigning on (historically e.g. immigration and the PVV).</p>
<p>One more complication here is that two parties, <em>GroenLinks</em> (GL) and the <em>Partij van de Arbeid</em> (PvdA), campaigned under a single banner, referred to here as <em>GL-PvdA</em>. When comparing to previous elections, polls and election outcomes should probably be summed across those two parties to better reflect the trends.</p>
<details>
<summary>Show code</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>data_parties <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tribble</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">~</span>party, <span style="color:#f92672">~</span>leftright, <span style="color:#f92672">~</span>progcon, <span style="color:#f92672">~</span>color, <span style="color:#f92672">~</span>text_color,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;VVD&#34;</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">-32</span>, <span style="color:#e6db74">&#34;#EE6F2D&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;D66&#34;</span>, <span style="color:#ae81ff">-5</span>, <span style="color:#ae81ff">58</span>, <span style="color:#e6db74">&#34;#4DAA4F&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;GL-PvdA&#34;</span>, <span style="color:#ae81ff">-55</span>, <span style="color:#ae81ff">66</span>, <span style="color:#e6db74">&#34;#CD3029&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PVV&#34;</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">-74</span>, <span style="color:#e6db74">&#34;grey92&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CDA&#34;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">-24</span>, <span style="color:#e6db74">&#34;#62C45D&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SP&#34;</span>, <span style="color:#ae81ff">-77</span>, <span style="color:#ae81ff">21</span>, <span style="color:#e6db74">&#34;#DA3732&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;FvD&#34;</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">-92</span>, <span style="color:#e6db74">&#34;#9B2820&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PvdD&#34;</span>, <span style="color:#ae81ff">-95</span>, <span style="color:#ae81ff">82</span>, <span style="color:#e6db74">&#34;#317142&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CU&#34;</span>, <span style="color:#ae81ff">-32</span>, <span style="color:#ae81ff">21</span>, <span style="color:#e6db74">&#34;#46A4E2&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Volt&#34;</span>, <span style="color:#ae81ff">-14</span>, <span style="color:#ae81ff">84</span>, <span style="color:#e6db74">&#34;#4A2975&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;JA21&#34;</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">-89</span>, <span style="color:#e6db74">&#34;#242C54&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SGP&#34;</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">-42</span>, <span style="color:#e6db74">&#34;#DA632C&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;DENK&#34;</span>, <span style="color:#ae81ff">-68</span>, <span style="color:#ae81ff">32</span>, <span style="color:#e6db74">&#34;#50B4B1&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;50PLUS&#34;</span>, <span style="color:#ae81ff">-23</span>, <span style="color:#ae81ff">-3</span>, <span style="color:#e6db74">&#34;#8C3D83&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BBB&#34;</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">-42</span>, <span style="color:#e6db74">&#34;#9DBD43&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BIJ1&#34;</span>, <span style="color:#ae81ff">-95</span>, <span style="color:#ae81ff">92</span>, <span style="color:#e6db74">&#34;#FFFD54&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BVNL&#34;</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">-89</span>, <span style="color:#e6db74">&#34;#1D2540&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;NSC&#34;</span>, <span style="color:#ae81ff">-9</span>, <span style="color:#ae81ff">-8</span>, <span style="color:#e6db74">&#34;#121439&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data_historical_parties <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tribble</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">~</span>party, <span style="color:#f92672">~</span>hist_leftright, <span style="color:#f92672">~</span>hist_progcon, <span style="color:#f92672">~</span>hist_color, <span style="color:#f92672">~</span>hist_text_color,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PvdA&#34;</span>, <span style="color:#ae81ff">-65</span>, <span style="color:#ae81ff">50</span>, <span style="color:#e6db74">&#34;#D22C21&#34;</span>, <span style="color:#e6db74">&#34;grey95&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;GroenLinks&#34;</span>, <span style="color:#ae81ff">-70</span>, <span style="color:#ae81ff">68</span>, <span style="color:#e6db74">&#34;#5BA546&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;ChristenUnie&#34;</span>, <span style="color:#ae81ff">-32</span>, <span style="color:#ae81ff">21</span>, <span style="color:#e6db74">&#34;#47A6E5&#34;</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div></details>
<p>Recreating the political compass is fairly simple once the data is loaded. It&rsquo;s in principle simply a scatterplot. Making it look informative by labeling the points directly and adding the colors and annotations in an informative matter is the only challenge here.</p>
<details>
<summary>Show code</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>compass_text <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tribble</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">~</span>leftright, <span style="color:#f92672">~</span>progcon, <span style="color:#f92672">~</span>label,
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">-100</span>, <span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#34;Left&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#34;Right&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">96</span>, <span style="color:#e6db74">&#34;Progressive&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">-96</span>, <span style="color:#e6db74">&#34;Conservative&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data_parties <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(party <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>(party, <span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;-\n&#34;</span>)) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> leftright, y <span style="color:#f92672">=</span> progcon, color <span style="color:#f92672">=</span> color)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_hline</span>(yintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> compass_text, <span style="color:#a6e22e">aes</span>(label <span style="color:#f92672">=</span> label),
</span></span><span style="display:flex;"><span>    size <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>    hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, fontface <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(label <span style="color:#f92672">=</span> party, color <span style="color:#f92672">=</span> text_color),
</span></span><span style="display:flex;"><span>    size <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>, lineheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    fontface <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;**Dutch political spectrum**&#34;</span>,
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;**Source**: KiesKompas&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>(
</span></span><span style="display:flex;"><span>    limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-100</span>, <span style="color:#ae81ff">100</span>),
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_continuous</span>(
</span></span><span style="display:flex;"><span>    limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-100</span>, <span style="color:#ae81ff">100</span>),
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_color_identity</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_equal</span>(clip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;off&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_minimal</span>(base_family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(
</span></span><span style="display:flex;"><span>    text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>),
</span></span><span style="display:flex;"><span>    plot.title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>, margin <span style="color:#f92672">=</span> <span style="color:#a6e22e">margin</span>(l <span style="color:#f92672">=</span> <span style="color:#ae81ff">-50</span>)),
</span></span><span style="display:flex;"><span>    plot.caption.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(margin <span style="color:#f92672">=</span> <span style="color:#a6e22e">margin</span>(t <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, r <span style="color:#f92672">=</span> <span style="color:#ae81ff">-50</span>)),
</span></span><span style="display:flex;"><span>    panel.grid <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>()
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<img src="index.markdown_strict_files/figure-markdown_strict/plot-political-spectrum-1.png" width="768" />
<div class="sidenote"  style="padding-top: 12em;">Geert Wilders is also the party&rsquo;s sole member (<a href="https://en.wikipedia.org/wiki/Party_for_Freedom#Organisation_and_support">link</a>)</div>
<p>It&rsquo;s immediately visible that the political parties (as broken down by <em>KiesKompas</em>) are aligned across a diagonal from right and conservative to left and progressive. Parties that are both left-wing and conservative, or right-wing and progressive are not really present in the mainstream Dutch political system (or in most foreign ones as far as I&rsquo;m aware). There are three parties in the lower-right corner (FvD, JA21, and BVNL). JA21 and BVNL are both factions that left the FvD after internal disagreement. The PVV is perhaps best known internationally for their leader <a href="https://www.britannica.com/biography/Geert-Wilders">Geert Wilders</a>. According to <em>KiesKompas</em> they are somewhere in the middle between left and right-wing, but in this case the party can probably be best described as <em>populist</em>, adapting both policies from the left and right. Internationally, they associate most with far-right parties and in the Netherlands they are also commonly called far-right.</p>
<p>The only squarely left-wing party of significance this election is the coalition GL-PvdA, led by former EU Commissioner <a href="https://www.theguardian.com/world/2023/jul/20/eu-climate-chief-frans-timmermans-quits-to-run-in-dutch-elections">Frans Timmermans</a>.</p>
<p>Before I move to the lastest polls, I can show how the seats have been distributed across the political parties over the past election cycles. For this I&rsquo;ll quickly scrape the <a href="https://www.parlement.com">parlement.com</a> website for the seat distribution across the past few elections.</p>
<details>
<summary>Show code</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>data_tk_history <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;https://www.parlement.com/id/vh8lnhronvx6/zetelverdeling_tweede_kamer&#34;</span> <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">read_html</span>() <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">html_elements</span>(<span style="color:#e6db74">&#34;table&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">html_table</span>() <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">first</span>() <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  janitor<span style="color:#f92672">::</span><span style="color:#a6e22e">clean_names</span>() <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rename_with</span>(<span style="color:#f92672">~</span> <span style="color:#a6e22e">str_glue</span>(<span style="color:#e6db74">&#34;election_{str_sub(.x, 2, 5)}&#34;</span>)) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rename</span>(party <span style="color:#f92672">=</span> election_arti) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    party <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_extract</span>(party, <span style="color:#e6db74">&#34;[^&lt;!]+&#34;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">across</span>(<span style="color:#a6e22e">starts_with</span>(<span style="color:#e6db74">&#34;election&#34;</span>), as.integer)
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<p>Then we can merge this dataset with the metadata tibble I created earlier to get the colors so I can use them in plotting. This plot is a simple &ldquo;time-series&rdquo;-like plot using <code>geom_path()</code>. The biggest challenge here was to annotate all the parties properly. I chose for a combination of both labeling each line explicitly and adding a legend with the specification for each color. However, since many parties use very similar colors this legend alone was not enough.</p>
<details>
<summary>Show code</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>data_tk_hist <span style="color:#f92672">&lt;-</span> data_tk_history <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">left_join</span>(data_parties, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;party&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">left_join</span>(data_historical_parties, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;party&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#a6e22e">coalesce</span>(color, hist_color),
</span></span><span style="display:flex;"><span>    text_color <span style="color:#f92672">=</span> <span style="color:#a6e22e">coalesce</span>(text_color, hist_text_color)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>legend_list <span style="color:#f92672">&lt;-</span> data_tk_hist <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">select</span>(color, party) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">deframe</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data_tk_hist <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pivot_longer</span>(<span style="color:#a6e22e">starts_with</span>(<span style="color:#e6db74">&#34;election&#34;</span>),
</span></span><span style="display:flex;"><span>    names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;year&#34;</span>, values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;seats&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    year <span style="color:#f92672">=</span> <span style="color:#a6e22e">parse_number</span>(year)
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> year, y <span style="color:#f92672">=</span> seats, color <span style="color:#f92672">=</span> color)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_hline</span>(yintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(
</span></span><span style="display:flex;"><span>    xintercept <span style="color:#f92672">=</span> <span style="color:#a6e22e">na.omit</span>(<span style="color:#a6e22e">names</span>(data_tk_hist) <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">parse_number</span>()),
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_path</span>(linewidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, key_glyph <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;point&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  ggrepel<span style="color:#f92672">::</span><span style="color:#a6e22e">geom_text_repel</span>(
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> . <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">slice_max</span>(year),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(label <span style="color:#f92672">=</span> party),
</span></span><span style="display:flex;"><span>    xlim <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2021</span>, <span style="color:#66d9ef">NA</span>), min.segment.length <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, fontface <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Historical seat distribution&lt;br&gt;in the past few elections&#34;</span>,
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Number of seats in parliament&#34;</span>,
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;**Source**: parlement.com&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>(
</span></span><span style="display:flex;"><span>    breaks <span style="color:#f92672">=</span> <span style="color:#a6e22e">na.omit</span>(<span style="color:#a6e22e">names</span>(data_tk_hist) <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">parse_number</span>()),
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1.5</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_continuous</span>(
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_color_identity</span>(
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> legend_list,
</span></span><span style="display:flex;"><span>    guide <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_legend</span>(override.aes <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>), nrow <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_cartesian</span>(clip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;off&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_minimal</span>(base_family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(
</span></span><span style="display:flex;"><span>    text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>),
</span></span><span style="display:flex;"><span>    plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
</span></span><span style="display:flex;"><span>    plot.title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(),
</span></span><span style="display:flex;"><span>    plot.caption.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.margin <span style="color:#f92672">=</span> <span style="color:#a6e22e">margin</span>(l <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, t <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>),
</span></span><span style="display:flex;"><span>    legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>,
</span></span><span style="display:flex;"><span>    panel.grid.major.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
</span></span><span style="display:flex;"><span>    panel.grid.minor.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>()
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<img src="index.markdown_strict_files/figure-markdown_strict/plot-seat-historical-distributions-1.png" width="768" />
<div class="sidenote" >In contrast to <a href="https://www.britannica.com/biography/Geert-Wilders">Geert Wilders</a>, <a href="https://www.britannica.com/biography/Mark-Rutte">Mark Rutte</a> does not have an elaborate entry in the Encyclopedia Brittanica</div>
<p>This plot immediately shows the dominance of the VVD, the party of <a href="https://en.wikipedia.org/wiki/Mark_Rutte">Mark Rutte</a> who is quite well-known internationally. The PvdA, which internationally associates with traditional labour parties, used to be the biggest opponent to the centre-right CDA and the right-wing VVD, but have since then failed to connect with the voters.</p>
<div class="sidenote" >I scraped this data earlier in the week, so the current table online does not reflect the data used here</div>
<p>Let&rsquo;s now also look at some polls to see what election night might bring. For this I&rsquo;ll scrape the results from <a href="https://www.ipsos.com">Ipsos</a>. It contains the polls from week 44 and week 46.</p>
<details>
<summary>Show code</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>data_polls_pre <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;https://www.ipsos.com/sites/default/files/nl/nl/politiekebarometer/Link_Tabel.html&#34;</span> <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">read_html</span>() <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">html_elements</span>(<span style="color:#e6db74">&#34;table&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">html_table</span>(header <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">first</span>() <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  janitor<span style="color:#f92672">::</span><span style="color:#a6e22e">clean_names</span>() <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(<span style="color:#a6e22e">nchar</span>(x) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rename</span>(
</span></span><span style="display:flex;"><span>    party <span style="color:#f92672">=</span> x,
</span></span><span style="display:flex;"><span>    current_perc <span style="color:#f92672">=</span> tweede_kamer,
</span></span><span style="display:flex;"><span>    current_seats <span style="color:#f92672">=</span> tweede_kamer_2,
</span></span><span style="display:flex;"><span>    polls_perc_wk_44 <span style="color:#f92672">=</span> week_441_nov_23,
</span></span><span style="display:flex;"><span>    polls_seats_wk_44 <span style="color:#f92672">=</span> week_441_nov_23_2,
</span></span><span style="display:flex;"><span>    polls_perc_wk_46 <span style="color:#f92672">=</span> week_4615_nov_23,
</span></span><span style="display:flex;"><span>    polls_seats_wk_46 <span style="color:#f92672">=</span> week_4615_nov_23_2
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(<span style="color:#a6e22e">across</span>(<span style="color:#f92672">-</span>party, as.numeric))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data_polls_pre <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">write_rds</span>(<span style="color:#e6db74">&#34;./data/polls_wk_46.rds&#34;</span>)
</span></span></code></pre></div></details>
<p>From this table I&rsquo;ll use only the polls from week 46 (latest available at the time). To better compare the polls to the current situation without drowning out the most important data I&rsquo;ll show the current seat distribution in grey, and the predicted seats in red.</p>
<details>
<summary>Show code for the plot</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>data_polls_pre_new <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_rds</span>(<span style="color:#e6db74">&#34;./data/polls_wk_46.rds&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">bind_rows</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">read_rds</span>(<span style="color:#e6db74">&#34;./data/polls_wk_46.rds&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">filter</span>(party <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;GL&#34;</span>, <span style="color:#e6db74">&#34;PvdA&#34;</span>)) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">summarise</span>(
</span></span><span style="display:flex;"><span>        party <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;GL-PvdA&#34;</span>, <span style="color:#a6e22e">across</span>(<span style="color:#f92672">-</span>party, sum)
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(party) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">summarise</span>(<span style="color:#a6e22e">across</span>(<span style="color:#a6e22e">everything</span>(), sum)) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(<span style="color:#f92672">!</span>party <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;GL&#34;</span>, <span style="color:#e6db74">&#34;PvdA&#34;</span>)) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(party <span style="color:#f92672">=</span> <span style="color:#a6e22e">case_when</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">str_detect</span>(party, <span style="color:#e6db74">&#34;50&#34;</span>) <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;50PLUS&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">str_detect</span>(party, <span style="color:#e6db74">&#34;VOLT&#34;</span>) <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;Volt&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">TRUE</span> <span style="color:#f92672">~</span> party
</span></span><span style="display:flex;"><span>  ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data_polls_pre_new <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pivot_longer</span>(
</span></span><span style="display:flex;"><span>    cols <span style="color:#f92672">=</span> <span style="color:#a6e22e">contains</span>(<span style="color:#e6db74">&#34;seats&#34;</span>),
</span></span><span style="display:flex;"><span>    names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;seats_var&#34;</span>, values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;n_seats&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span>(seats_var <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;current_seats&#34;</span>, <span style="color:#e6db74">&#34;polls_seats_wk_46&#34;</span>)) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> n_seats, y <span style="color:#f92672">=</span> <span style="color:#a6e22e">reorder</span>(party, polls_perc_wk_46), fill <span style="color:#f92672">=</span> seats_var)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(), key_glyph <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;point&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> n_seats <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.5</span>, label <span style="color:#f92672">=</span> n_seats),
</span></span><span style="display:flex;"><span>    position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;white&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Predicted seat distribution from Week 46&#34;</span>,
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    fill <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;**Source**: Ipsos&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>(
</span></span><span style="display:flex;"><span>    position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;top&#34;</span>,
</span></span><span style="display:flex;"><span>    limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">NA</span>),
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">NA</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_manual</span>(
</span></span><span style="display:flex;"><span>    values <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;current_seats&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;grey60&#34;</span>, <span style="color:#e6db74">&#34;polls_seats_wk_46&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;firebrick&#34;</span>),
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;Current seats&#34;</span>, <span style="color:#e6db74">&#34;Predicted seats (wk 46)&#34;</span>),
</span></span><span style="display:flex;"><span>    guide <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_legend</span>(override.aes <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(shape <span style="color:#f92672">=</span> <span style="color:#ae81ff">21</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_minimal</span>(base_family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(
</span></span><span style="display:flex;"><span>    plot.title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">24</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
</span></span><span style="display:flex;"><span>    plot.caption.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(),
</span></span><span style="display:flex;"><span>    legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.8</span>, <span style="color:#ae81ff">0.2</span>)
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<img src="index.markdown_strict_files/figure-markdown_strict/plot-ipsos-polls-wk46-1.png" width="768" />
<p>The biggest thing to notice here is the party NSC which was started by Pieter Omtzigt, formerly a member of the CDA. This party participates in the 2023 parliamentary elections for the first time, so it doesn&rsquo;t have anything to compare to. According to these polls, the NSC will go in one go to 26 seats. The VVD is still the biggest, but loses a few seats. Other than the VVD, the biggest losers in these polls are the D66, CDA, FvD, and SP.</p>
<div class="sidenote" >Tom Louwerse also contributes to the <a href="https://pollingindicator.com">Irish Polling Indicator</a> using the same methods, which describes the methods in English (also, see <a href="https://doi.org/10.1080/07907184.2016.1213719">this article</a>)</div>
<p>This is just one plot from one pollster. There is however a polling aggregator, called the <a href="https://peilingwijzer.tomlouwerse.nl"><em>Peilingwijzer</em></a>, which is maintained by political scientist <a href="https://www.tomlouwerse.nl">Tom Louwerse</a> at Leiden University. It uses a Bayesian approach to weigh a collection of polls from various sources (description in <a href="https://peilingwijzer.tomlouwerse.nl/methode.html#statistisch-model">Dutch</a> and <a href="https://pollingindicator.com/method/">English</a>). An (probably earlier) version of the code is available on <a href="https://dataverse.harvard.edu/file.xhtml?fileId=4459988&amp;version=1.0">Dataverse</a> This way he gets a better estimate of the uncertainty across several pollsters and polling dates. I know he does a lot of his analyses in R, so I&rsquo;ll try to recreate his plot on the <a href="https://peilingwijzer.tomlouwerse.nl">main website</a> just as a challenge (and perhaps make one or two things a bit more aesthetically pleasing). It seems he uses the somewhat niche (at least in my field) <code>geom_crossbar()</code>.</p>
<details>
<summary>Show code</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>polls_peilingwijzer <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tribble</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">~</span>party, <span style="color:#f92672">~</span>range_min, <span style="color:#f92672">~</span>range_max,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;VVD&#34;</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">30</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PVV&#34;</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">29</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;GL-PvdA&#34;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">27</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;NSC&#34;</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">23</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;D66&#34;</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">11</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BBB&#34;</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SP&#34;</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PvdD&#34;</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CU&#34;</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CDA&#34;</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;FvD&#34;</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;DENK&#34;</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Volt&#34;</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SGP&#34;</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;JA21&#34;</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BVNL&#34;</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BIJ1&#34;</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;50PLUS&#34;</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>polls_peilingwijzer <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(data_parties) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(data_polls_pre_new <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#a6e22e">select</span>(party, current_seats)) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(color <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;grey92&#34;</span>, <span style="color:#e6db74">&#34;grey&#34;</span>, color),
</span></span><span style="display:flex;"><span>    range_max_label <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(range_max <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">str_glue</span>(<span style="color:#e6db74">&#34;{range_min}-{range_max}&#34;</span>), range_max
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> current_seats, y <span style="color:#f92672">=</span> <span style="color:#a6e22e">reorder</span>(party, range_max),
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> color, fill <span style="color:#f92672">=</span> color
</span></span><span style="display:flex;"><span>  )) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>, linewidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;transparent&#34;</span>, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.25</span>, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, just <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_crossbar</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(
</span></span><span style="display:flex;"><span>      x <span style="color:#f92672">=</span> range_min <span style="color:#f92672">+</span> <span style="color:#a6e22e">round</span>((range_max <span style="color:#f92672">-</span> range_min) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>      xmin <span style="color:#f92672">=</span> range_min, xmax <span style="color:#f92672">=</span> range_max,
</span></span><span style="display:flex;"><span>      color <span style="color:#f92672">=</span> colorspace<span style="color:#f92672">::</span><span style="color:#a6e22e">lighten</span>(color, amount <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, linewidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, fatten <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> range_min, label <span style="color:#f92672">=</span> range_min),
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>,
</span></span><span style="display:flex;"><span>    nudge_x <span style="color:#f92672">=</span> <span style="color:#ae81ff">-0.75</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> range_max, label <span style="color:#f92672">=</span> range_max_label),
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>,
</span></span><span style="display:flex;"><span>    nudge_x <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(polls_peilingwijzer<span style="color:#f92672">$</span>range_max <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0.75</span>)
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> <span style="color:#a6e22e">tibble</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> <span style="color:#ae81ff">27</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Previous\nelections&#34;</span>),
</span></span><span style="display:flex;"><span>    inherit.aes <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>,
</span></span><span style="display:flex;"><span>    size <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>,
</span></span><span style="display:flex;"><span>    hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, lineheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.75</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_curve</span>(
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> <span style="color:#a6e22e">tibble</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> <span style="color:#ae81ff">26.75</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>, xend <span style="color:#f92672">=</span> <span style="color:#ae81ff">24.2</span>, yend <span style="color:#f92672">=</span> <span style="color:#ae81ff">13.2</span>),
</span></span><span style="display:flex;"><span>    inherit.aes <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>, curvature <span style="color:#f92672">=</span> <span style="color:#ae81ff">-0.1</span>,
</span></span><span style="display:flex;"><span>    arrow <span style="color:#f92672">=</span> <span style="color:#a6e22e">arrow</span>(length <span style="color:#f92672">=</span> <span style="color:#a6e22e">unit</span>(<span style="color:#ae81ff">0.4</span>, <span style="color:#e6db74">&#34;lines&#34;</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Latest _Peilingwijzer_&#34;</span>,
</span></span><span style="display:flex;"><span>    subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;_Peilingwijzer_ combines the polls from I&amp;O Research &amp; Ipsos/EenVandaag&#34;</span>,
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Seats&#34;</span>,
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;_Peilingwijzer_, based on I&amp;O Research &amp; Ipsos&amp;EenVandaag&lt;br&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Tom Louwerse, Universiteit Leiden,&lt;br&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Last change: 21-11-2023&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>(
</span></span><span style="display:flex;"><span>    limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">NA</span>),
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">NA</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_discrete</span>(
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_color_identity</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_identity</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_minimal</span>(base_family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(
</span></span><span style="display:flex;"><span>    plot.title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
</span></span><span style="display:flex;"><span>    plot.subtitle <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">14</span>),
</span></span><span style="display:flex;"><span>    plot.caption.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(lineheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.75</span>),
</span></span><span style="display:flex;"><span>    axis.text.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, margin <span style="color:#f92672">=</span> <span style="color:#a6e22e">margin</span>(t <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, r <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>)),
</span></span><span style="display:flex;"><span>    panel.grid.major.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>()
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<img src="index.markdown_strict_files/figure-markdown_strict/peilingwijzer-plot-1.png" width="768" />
<div class="omission"></div>
<h2 id="22-november-2100">22 November 21:00</h2>
<div class="sidenote" >There are three municipalities in the Carribean that can vote until 02:00 CET</div>
<p>The voting booths (at least in the mainland part of the Netherlands) close at 21:00. This also marks the release of the first exit polls. I&rsquo;m just copying the numbers from the TV broadcast as they come in and saving them in a <code>tibble()</code> using the <code>tribble()</code> function.</p>
<details>
<summary>Show code for the plot</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>data_current_seats <span style="color:#f92672">&lt;-</span> data_polls_pre_new <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">select</span>(party, current_perc, current_seats)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>exit_polls_2100 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tribble</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">~</span>party, <span style="color:#f92672">~</span>polls_2100,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;VVD&#34;</span>, <span style="color:#ae81ff">23</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PVV&#34;</span>, <span style="color:#ae81ff">35</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;GL-PvdA&#34;</span>, <span style="color:#ae81ff">26</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;NSC&#34;</span>, <span style="color:#ae81ff">20</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;D66&#34;</span>, <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BBB&#34;</span>, <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SP&#34;</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PvdD&#34;</span>, <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CU&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CDA&#34;</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;FvD&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;DENK&#34;</span>, <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Volt&#34;</span>, <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SGP&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;JA21&#34;</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BVNL&#34;</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BIJ1&#34;</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;50PLUS&#34;</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>exit_polls_2100 <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(data_parties, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;party&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(data_current_seats, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;party&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pivot_longer</span>(
</span></span><span style="display:flex;"><span>    cols <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(polls_2100, current_seats),
</span></span><span style="display:flex;"><span>    names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;variable&#34;</span>, values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;seats&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(<span style="color:#a6e22e">str_detect</span>(variable, <span style="color:#e6db74">&#34;current&#34;</span>), <span style="color:#e6db74">&#34;grey80&#34;</span>, color),
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(color <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;grey92&#34;</span>, <span style="color:#e6db74">&#34;grey40&#34;</span>, color),
</span></span><span style="display:flex;"><span>    text_color <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(<span style="color:#a6e22e">str_detect</span>(variable, <span style="color:#e6db74">&#34;polls&#34;</span>) <span style="color:#f92672">&amp;</span> party <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;PVV&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;white&#34;</span>, text_color
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    text_color <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(<span style="color:#a6e22e">str_detect</span>(variable, <span style="color:#e6db74">&#34;current&#34;</span>), <span style="color:#e6db74">&#34;#333333&#34;</span>, text_color)
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> seats, y <span style="color:#f92672">=</span> <span style="color:#a6e22e">reorder</span>(party, current_perc),
</span></span><span style="display:flex;"><span>    group <span style="color:#f92672">=</span> variable, fill <span style="color:#f92672">=</span> color
</span></span><span style="display:flex;"><span>  )) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(), key_glyph <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;point&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> seats <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.5</span>, label <span style="color:#f92672">=</span> seats, color <span style="color:#f92672">=</span> text_color),
</span></span><span style="display:flex;"><span>    position <span style="color:#f92672">=</span> <span style="color:#a6e22e">position_dodge</span>(width <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>    size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Exit polls from 22 November 22:00&#34;</span>,
</span></span><span style="display:flex;"><span>    subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Colored bars show the predicted number of seats,&lt;br&gt;grey bars indicate current seats&#34;</span>,
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Number of seats in parliament&#34;</span>,
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    fill <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;**Source**: Ipsos, comissioned by NOS and RTL&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>(
</span></span><span style="display:flex;"><span>    position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;top&#34;</span>,
</span></span><span style="display:flex;"><span>    limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">NA</span>),
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_color_identity</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_identity</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_minimal</span>(base_family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(
</span></span><span style="display:flex;"><span>    plot.title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">24</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
</span></span><span style="display:flex;"><span>    plot.subtitle <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(lineheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.67</span>),
</span></span><span style="display:flex;"><span>    plot.caption.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(),
</span></span><span style="display:flex;"><span>    axis.text.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>),
</span></span><span style="display:flex;"><span>    legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.8</span>, <span style="color:#ae81ff">0.2</span>)
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<img src="index.markdown_strict_files/figure-markdown_strict/plot-exit-polls-2100-1.png" width="768" />
<p>Out of the blue, contrary to basically any serious poll, the PVV party from Geert Wilders appears to become the largest party, followed by GL-PvdA. This is a major upset that would open the door for a very right and conservative government. This would unfortunately mean the latest blow to meaningful climate action, an increase anti-immigrant policy, decreased government support for Ukraine, increased support for Israel and the atrocities they commit in Gaza and the rest of Palestine, and possibly a host of challenges to the rule of law in the Netherlands.</p>
<div class="omission"></div>
<h2 id="22-november-2200">22 November 22:00</h2>
<p>An hour later, at 22:00, the next exit polls was released. After the shock of the first one I think everyone was quite nervous to see whether these next exit polls were consistent with the first or if there was some course correction, but the second exit polls were very consistent. No party changed more than 1 seat in either direction compared to the polls released at 21:00. I&rsquo;ll try to visualize the difference, showing how flat the differences are.</p>
<details>
<summary>Show code for the plot</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>exit_polls_2200 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tribble</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">~</span>party, <span style="color:#f92672">~</span>polls_2200,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;VVD&#34;</span>, <span style="color:#ae81ff">24</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PVV&#34;</span>, <span style="color:#ae81ff">35</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;GL-PvdA&#34;</span>, <span style="color:#ae81ff">25</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;NSC&#34;</span>, <span style="color:#ae81ff">20</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;D66&#34;</span>, <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BBB&#34;</span>, <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SP&#34;</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PvdD&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CU&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CDA&#34;</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;FvD&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;DENK&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Volt&#34;</span>, <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SGP&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;JA21&#34;</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BVNL&#34;</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BIJ1&#34;</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;50PLUS&#34;</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>exit_polls_2200 <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(exit_polls_2100) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(data_parties, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;party&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pivot_longer</span>(
</span></span><span style="display:flex;"><span>    cols <span style="color:#f92672">=</span> <span style="color:#a6e22e">starts_with</span>(<span style="color:#e6db74">&#34;polls&#34;</span>),
</span></span><span style="display:flex;"><span>    names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;time&#34;</span>, values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;seats&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    time <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_remove</span>(time, <span style="color:#e6db74">&#34;polls_&#34;</span>),
</span></span><span style="display:flex;"><span>    time <span style="color:#f92672">=</span> lubridate<span style="color:#f92672">::</span><span style="color:#a6e22e">parse_date_time</span>(time, <span style="color:#e6db74">&#34;HM&#34;</span>, tz <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>),
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(party <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;PVV&#34;</span>, <span style="color:#e6db74">&#34;grey40&#34;</span>, color),
</span></span><span style="display:flex;"><span>    text_color <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(party <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;PVV&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;white&#34;</span>, text_color
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> time, y <span style="color:#f92672">=</span> seats, color <span style="color:#f92672">=</span> color)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_path</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_point</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(label <span style="color:#f92672">=</span> seats, color <span style="color:#f92672">=</span> text_color),
</span></span><span style="display:flex;"><span>    size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  ggrepel<span style="color:#f92672">::</span><span style="color:#a6e22e">geom_text_repel</span>(
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> . <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">group_by</span>(party) <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">slice_max</span>(time),
</span></span><span style="display:flex;"><span>    mapping <span style="color:#f92672">=</span> <span style="color:#a6e22e">aes</span>(label <span style="color:#f92672">=</span> party),
</span></span><span style="display:flex;"><span>    hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, seed <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>,
</span></span><span style="display:flex;"><span>    max.overlaps <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>,
</span></span><span style="display:flex;"><span>    fontface <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Difference in exit polls&lt;br&gt;between 21:00 and 22:00&#34;</span>,
</span></span><span style="display:flex;"><span>    subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Little change across the board, maximum difference is 1 seat&#34;</span>,
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Number of seats&#34;</span>,
</span></span><span style="display:flex;"><span>    caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;**Source**: Ipsos, comissioned by NOS and RTL&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_datetime</span>(
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">500</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_color_identity</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_minimal</span>(base_family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">coord_fixed</span>(ratio <span style="color:#f92672">=</span> <span style="color:#ae81ff">120</span>, clip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;off&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(
</span></span><span style="display:flex;"><span>    plot.title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
</span></span><span style="display:flex;"><span>    plot.subtitle <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(lineheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.67</span>),
</span></span><span style="display:flex;"><span>    plot.caption.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(),
</span></span><span style="display:flex;"><span>    legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.8</span>, <span style="color:#ae81ff">0.2</span>)
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<img src="index.markdown_strict_files/figure-markdown_strict/plot-exit-polls-2200-1.png" width="768" />
<div class="omission"></div>
<h2 id="23-november">23 November</h2>
<div class="sidenote"  style="padding-top: 2em;">The Dutch government is based on coalitions, so the PVV will need to collaborate with other parties to form a government</div>
<p>It&rsquo;s the day after and basically all news agencies (e.g. <a href="https://nos.nl/collectie/13958/artikel/2498903">NOS</a>, <a href="https://www.bbc.com/news/world-europe-67504272">BBC</a>, <a href="https://edition.cnn.com/2023/11/23/europe/geert-wilders-dutch-election-analysis-intl/index.html">CNN</a>, <a href="https://www.nrk.no/urix/1.16648165">NRK</a>) are (justifiably) shocked by the fact that Geert Wilders likely will become the next prime minister in the Netherlands for however long his government will last. The formal results will be announced once all votes are properly tallied and checked again, so for this part of the analyses we can only rely on the latest results with almost all votes counted at least once. The official result will be published by the <a href="https://www.kiesraad.nl/"><em>Kiesraad</em></a> one about a week, but it publishes the <a href="https://www.kiesraad.nl/verkiezingen/tweede-kamer/uitslagen/uitslagen-per-gemeente-tweede-kamer">preliminary results</a> also, so I&rsquo;ll just copy the data from there. I already created the absolute seat comparison, and since not much changed I thought perhaps I could look at the percentage change from the current seats.</p>
<details>
<summary>Show code for the plot</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>preliminary_results <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tribble</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">~</span>party, <span style="color:#f92672">~</span>prelim_results,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;VVD&#34;</span>, <span style="color:#ae81ff">24</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PVV&#34;</span>, <span style="color:#ae81ff">37</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;GL-PvdA&#34;</span>, <span style="color:#ae81ff">25</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;NSC&#34;</span>, <span style="color:#ae81ff">20</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;D66&#34;</span>, <span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BBB&#34;</span>, <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SP&#34;</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;PvdD&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CU&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;CDA&#34;</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;FvD&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;DENK&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Volt&#34;</span>, <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;SGP&#34;</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;JA21&#34;</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BVNL&#34;</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;BIJ1&#34;</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;50PLUS&#34;</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>preliminary_results_diff <span style="color:#f92672">&lt;-</span> preliminary_results <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(data_parties, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;party&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(data_current_seats, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;party&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    rel_diff <span style="color:#f92672">=</span> (prelim_results <span style="color:#f92672">/</span> current_seats) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">replace_na</span>(<span style="color:#a6e22e">list</span>(rel_diff <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    rel_diff_label <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_glue</span>(<span style="color:#e6db74">&#34;{round(rel_diff * 100)}%&#34;</span>),
</span></span><span style="display:flex;"><span>    rel_diff_label <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(<span style="color:#a6e22e">str_detect</span>(rel_diff_label, <span style="color:#e6db74">&#34;Inf&#34;</span>), <span style="color:#e6db74">&#34;New party&#34;</span>, rel_diff_label),
</span></span><span style="display:flex;"><span>    text_color <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(rel_diff <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;#333333&#34;</span>, text_color)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>preliminary_results_diff <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> rel_diff, y <span style="color:#f92672">=</span> <span style="color:#a6e22e">reorder</span>(party, rel_diff), fill <span style="color:#f92672">=</span> color)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(
</span></span><span style="display:flex;"><span>    xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_vline</span>(
</span></span><span style="display:flex;"><span>    xintercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">-1</span>,
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#333333&#34;</span>,
</span></span><span style="display:flex;"><span>    linetype <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dashed&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_col</span>(
</span></span><span style="display:flex;"><span>    width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(label <span style="color:#f92672">=</span> rel_diff_label, color <span style="color:#f92672">=</span> text_color),
</span></span><span style="display:flex;"><span>    nudge_x <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(preliminary_results_diff<span style="color:#f92672">$</span>rel_diff <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">-0.5</span>, <span style="color:#ae81ff">0.05</span>),
</span></span><span style="display:flex;"><span>    hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_text</span>(
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> <span style="color:#a6e22e">tibble</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> <span style="color:#ae81ff">5.4</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;NSC is a new party&#34;</span>),
</span></span><span style="display:flex;"><span>    inherit.aes <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>,
</span></span><span style="display:flex;"><span>    size <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>, family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>,
</span></span><span style="display:flex;"><span>    hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, lineheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.75</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_curve</span>(
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> <span style="color:#a6e22e">tibble</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> <span style="color:#ae81ff">5.5</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>, xend <span style="color:#f92672">=</span> <span style="color:#ae81ff">6.5</span>, yend <span style="color:#f92672">=</span> <span style="color:#ae81ff">17.5</span>),
</span></span><span style="display:flex;"><span>    inherit.aes <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>, curvature <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.2</span>,
</span></span><span style="display:flex;"><span>    arrow <span style="color:#f92672">=</span> <span style="color:#a6e22e">arrow</span>(length <span style="color:#f92672">=</span> <span style="color:#a6e22e">unit</span>(<span style="color:#ae81ff">0.4</span>, <span style="color:#e6db74">&#34;lines&#34;</span>))
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Relative difference with current seats in parliament&#34;</span>,
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Percentage change&#34;</span>,
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;**Source**: Ipsos, comissioned by NOS and RTL&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_x_continuous</span>(
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> scales<span style="color:#f92672">::</span><span style="color:#a6e22e">label_percent</span>(),
</span></span><span style="display:flex;"><span>    expand <span style="color:#f92672">=</span> <span style="color:#a6e22e">expansion</span>(add <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">1.2</span>)),
</span></span><span style="display:flex;"><span>    position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;top&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_color_identity</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_identity</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_minimal</span>(base_family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(
</span></span><span style="display:flex;"><span>    plot.title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
</span></span><span style="display:flex;"><span>    plot.subtitle <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(lineheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.67</span>),
</span></span><span style="display:flex;"><span>    plot.caption.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(),
</span></span><span style="display:flex;"><span>    axis.text.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>),
</span></span><span style="display:flex;"><span>    panel.grid.major.y <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
</span></span><span style="display:flex;"><span>    legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.8</span>, <span style="color:#ae81ff">0.2</span>)
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<img src="index.markdown_strict_files/figure-markdown_strict/plot-preliminary-results-1.png" width="768" />
<p>Since the NSC is a new party it&rsquo;s increase (no matter how little or large it would have been) is infinite. Since the party got 20 seats, I think it looks fairly logical to have it appear at the top. If it was a much smaller party, I would have maybe forced it to be shown at the bottom to incidate that this is a statistical anomaly. The <em>Boer Burger Beweging</em> (BBB) has one seat in the current parliament after their first participation in the previous election, but will increase to 7 in the next parliament that will be seated early December. There are two parties that according to these numbers will be removed from parliament (indicated by the 100% decrease in seats in parliament). I would say that having the most important numbers be somewhat squished on the left of the plot is perhaps not ideal, but it&rsquo;s a trade-off from showing the large increase in the NSC and BBB.</p>
<p>Next I wanted to look at the results per municipality to see if there were any trends I could identify. The <em>Kiesraad</em> publishes preliminary results per municipality also, but this data is quite a headache to scrape so I&rsquo;ll use the website <a href="https://allecijfers.nl/uitslag-tweede-kamer-verkiezingen-2023/"><em>AlleCijfers.nl</em></a> instead that more conveniently lists everything in an HTML table that we can scrape. See <a href="https://github.com/danielroelfs/danielroelfs.com/tree/main/content/blog/2023-dutch-elections/scrape_municipality_results.py">here</a> for the Python code to scrape the website.</p>
<details>
<summary>Show code</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>results_municipality <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_delim</span>(<span style="color:#e6db74">&#34;./data/election_results.csv&#34;</span>, delim <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;;&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">rename</span>(region <span style="color:#f92672">=</span> Regionaam) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">across</span>(<span style="color:#a6e22e">everything</span>(), <span style="color:#f92672">~</span> <span style="color:#a6e22e">str_remove</span>(.x, <span style="color:#e6db74">&#34;%&#34;</span>)),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">across</span>(<span style="color:#a6e22e">everything</span>(), <span style="color:#f92672">~</span> <span style="color:#a6e22e">str_replace</span>(.x, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span>)),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">across</span>(<span style="color:#f92672">-</span>region, parse_number)
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pivot_longer</span>(cols <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>region, names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;party&#34;</span>, values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;perc&#34;</span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">left_join</span>(data_parties) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    region <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_remove</span>(region, <span style="color:#e6db74">&#34;Gemeente&#34;</span>),
</span></span><span style="display:flex;"><span>    region <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_trim</span>(region)
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<p>To create the map, I downloaded a <em>geopackage</em> file from the <a href="https://www.cbs.nl"><em>Centraal Bureau voor de Statistiek</em></a> (CBS) page on <a href="https://www.cbs.nl/nl-nl/dossier/nederland-regionaal/geografische-data/cbs-gebiedsindelingen">geographical areas</a> where they share current and historical files on a number of divisions (provinces, municipalities, security regions, etc.). The <em>geopackage</em> format can be parsed with the <code>{sf}</code> package. The file contains several &ldquo;layers&rdquo; that can be listed through the <code>sf::st_layers(&lt;file&gt;)</code> functionality.</p>
<details>
<summary>Show code</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>geo_municipality <span style="color:#f92672">&lt;-</span> sf<span style="color:#f92672">::</span><span style="color:#a6e22e">st_read</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;./data/cbsgebiedsindelingen2023.gpkg&#34;</span>,
</span></span><span style="display:flex;"><span>  layer <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gemeente_gegeneraliseerd&#34;</span>,
</span></span><span style="display:flex;"><span>  quiet <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>
</span></span><span style="display:flex;"><span>) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  janitor<span style="color:#f92672">::</span><span style="color:#a6e22e">clean_names</span>()
</span></span></code></pre></div></details>
<p>The thing I was most interested in at first is how progressive or conservative (I&rsquo;ll refer to this as &ldquo;political identity&rdquo; from now on), and how left- and right-wing the municipalities are (&ldquo;political color&rdquo;). As noted before, the political color of the PVV is somewhat controversial, where <em>KiesKompas</em> would put in the centre-right due to it&rsquo;s populist agenda, the party is usually mentioned among the far-right parties, both nationally and internationally. I could change the value for this part of the analyses, but I&rsquo;m not comfortable setting another value, so look at the following plots with this caveat in mind. Considering the electoral victory the PVV won this election cycle, the plots should probabaly look more right-wing than the shown values represent.</p>
<div class="sidenote" >The weighted mean is implemented in R through the <code>weighted.mean()</code> function</div>
<p>For these plots I&rsquo;ll calculate two measures, the weighted mean of the political identity and the weighted mean of the political color. I&rsquo;ll use the percentages in each municipality as the weights and the values from <em>KiesKompas</em> to aggregate for each measure. It&rsquo;s important to note that there were many more parties the electorate could vote for, but not all were given a political identity or color by <em>KiesKompas</em>, so data from these (usually very small) parties is ignored.</p>
<details>
<summary>Show code for the plot</summary>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>summary_municipality <span style="color:#f92672">&lt;-</span> results_municipality <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">group_by</span>(region) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">summarise</span>(
</span></span><span style="display:flex;"><span>    mean_political_identity <span style="color:#f92672">=</span> <span style="color:#a6e22e">weighted.mean</span>(progcon, w <span style="color:#f92672">=</span> perc, na.rm <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>),
</span></span><span style="display:flex;"><span>    mean_political_color <span style="color:#f92672">=</span> <span style="color:#a6e22e">weighted.mean</span>(leftright, w <span style="color:#f92672">=</span> perc, na.rm <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">inner_join</span>(geo_municipality, by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;region&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;statnaam&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(summary_municipality <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_sf</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">aes</span>(geometry <span style="color:#f92672">=</span> geom, fill <span style="color:#f92672">=</span> mean_political_identity)
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Political identity&#34;</span>,
</span></span><span style="display:flex;"><span>    subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Is the municipalitiy more&lt;br&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &lt;span style=&#39;color: #B24334&#39;&gt;**progressive**&lt;/span&gt; or
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      &lt;span style=&#39;color: #4180B4&#39;&gt;**conservative**&lt;/span&gt;?&#34;</span>,
</span></span><span style="display:flex;"><span>    fill <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  scico<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_fill_scico</span>(
</span></span><span style="display:flex;"><span>    palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;vik&#34;</span>,
</span></span><span style="display:flex;"><span>    limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-50</span>, <span style="color:#ae81ff">50</span>),
</span></span><span style="display:flex;"><span>    guide <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_colorbar</span>(ticks <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>, barheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.75</span>, barwidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>, reverse <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>) <span style="color:#f92672">+</span> (
</span></span><span style="display:flex;"><span>  summary_municipality <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ggplot</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_sf</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">aes</span>(geometry <span style="color:#f92672">=</span> geom, fill <span style="color:#f92672">=</span> mean_political_color)
</span></span><span style="display:flex;"><span>    ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>      title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Political color&#34;</span>,
</span></span><span style="display:flex;"><span>      subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Is the municipalitiy more&lt;br&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &lt;span style=&#39;color: #B24334&#39;&gt;**left**&lt;/span&gt; or
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &lt;span style=&#39;color: #4180B4&#39;&gt;**right**&lt;/span&gt; leaning?&#34;</span>,
</span></span><span style="display:flex;"><span>      fill <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>
</span></span><span style="display:flex;"><span>    ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    scico<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_fill_scico</span>(
</span></span><span style="display:flex;"><span>      palette <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;vik&#34;</span>,
</span></span><span style="display:flex;"><span>      direction <span style="color:#f92672">=</span> <span style="color:#ae81ff">-1</span>,
</span></span><span style="display:flex;"><span>      limits <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-50</span>, <span style="color:#ae81ff">50</span>),
</span></span><span style="display:flex;"><span>      guide <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_colorbar</span>(ticks <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>, barheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.75</span>, barwidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>, reverse <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">plot_layout</span>(guides <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;collect&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">plot_annotation</span>(
</span></span><span style="display:flex;"><span>    caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Election results scraped from _AlleCijfers.nl_,&lt;br&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      Political identity and color mapped from _KiesKompas_&#34;</span>
</span></span><span style="display:flex;"><span>  ) <span style="color:#f92672">&amp;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme_void</span>(base_family <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;custom&#34;</span>) <span style="color:#f92672">&amp;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(
</span></span><span style="display:flex;"><span>    plot.title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
</span></span><span style="display:flex;"><span>    plot.subtitle <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(),
</span></span><span style="display:flex;"><span>    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_markdown</span>(lineheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>    plot.caption.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;plot&#34;</span>,
</span></span><span style="display:flex;"><span>    legend.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_blank</span>(),
</span></span><span style="display:flex;"><span>    legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div></details>
<img src="index.markdown_strict_files/figure-markdown_strict/plot-municipalities-1.png" width="768" />
<p>The first important thing to mention is that the <em>geopackage</em> file and the dataset with the election results have a slight mismatch. There is a difference of 5 municipalities. Should I use some time to find out which these 5 municipalities are? Probably. Do I have either time or motivation to do it right now? No, I don&rsquo;t. I&rsquo;m gonna assume it&rsquo;s due to different spellings, outdated files on either side, or some merging or aggregation in either dataset prior to downloading it that may be the cause. Another caveat to keep in mind.</p>
<p>Anyone with some familiarity of Dutch geography might immediately notice the large red spots in some familiar areas. As usual, the big cities and the cities with a significant population of younger people and/or students are markedly more progressive and left-wing than the surrounding areas, in particular the municipality in the east and south and following the <em>Biblebelt</em>. This is not a surprise for me, or anyone, but nice to see confirmed. To address the issue of the political color of the PVV, I tested replacing the value for the political color with 50 (the same as the VVD), which is a big increase from 9 given by <em>KiesKompas</em>. In this experiment (which I intentionally don&rsquo;t show here to stay true to the data reported), the two plots look very similar in color too in addition to trend already visible in the plot based on the data reported.</p>
<p>This was an interesting challenge to visualize data both accurately and responsibly. Despite the outcome of the election, it was fun to work with data as it came in. If I feel qualified to do so, I might repeat this post for the next elections for the Norwegian parliament in 2025 or the next Dutch election (whichever comes first). If you&rsquo;re reading this far down, thanks for your interest, and hope it was interesting and perhaps of some use to you.</p>

</div>

        </div>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/foundation.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
<script>
  hljs.highlightAll();
</script>


<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
  MathJax = {
      tex: {
        inlineMath: [ ['$','$'] ]
      }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>


<script src="https://unpkg.com/feather-icons"></script>
<script>
  feather.replace()
</script>

<div id="nav-border" class="container">
    
    <div class="nav-outer">
        <div class="nav-inner">
            
                
                    
                        <a class="internal" hyphens="none" href="/">
                            
                            Home
                        </a>
                    
                
                    
                        <a class="internal" hyphens="none" href="/blog">
                            
                            Blog
                        </a>
                    
                
                    
                
                    
                        <a class="internal" hyphens="none" href="/publications">
                            
                            Publications
                        </a>
                    
                
                    
                        <a class="internal" hyphens="none" href="/cv">
                            
                            CV
                        </a>
                    
                
                    
                        <a class="internal" hyphens="none" href="/about">
                            
                            About
                        </a>
                    
                
            
        </div>
    </div>
    
</div>

</body>
</html>
